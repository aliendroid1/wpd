<head>        
    <script src="writeHeaderData.js"></script>
    <title>WPD Resource Hub</title>
</head>
<body>
    <script src="writeNavbar.js"></script>

    <h1 class="text-center">Resources Submission</h1>
    <div class="container mt-3">
        <input type="hidden" id="id">
        <label>Case Number: </label><input type="text" class="form-control" id="case-number">
        <label>Name:        </label><input type="text" class="form-control" id="officer-name" disabled>
        <label>ID Number: </label>
        <input type="text" class="form-control" id="user-id" disabled >
        <label>Employee Rank: </label>
        <input type="text" class="form-control" id="user-rank" disabled >
        <label>Email:       </label><input type="email" class="form-control" id="officer-email" disabled>
        <label>Phone Number: </label>
        <input type="text" class="form-control" id="user-phone" disabled >
        <label>Station Phone Number: </label>
        <input type="text" class="form-control" id="user-stationNumber" disabled >
        <label>Departments:      </label><select class="form-control" id="departments">
        </select>
        <h5>Link Selection:</h5>
            <div class="checkbox"><label><input type="checkbox" value="">   WPD Section Website </label></div>
            <div class="checkbox"><label><input type="checkbox" value="">   WPD Website</label></div>
            <div class="checkbox"><label><input type="checkbox" value="">   Wichita Gov Website</label></div>
        <br>
        <p class="text-danger text-center" id="submit-warning">You must be signed in to submit a form!</p>
        <div class="d-flex justify-content-center"><button type="button" class="btn btn-warning" id="form-submit-button" onclick="submitPageForm()" disabled>Submit</button></div>
        <br>
    </div>
    <script>
        firebase.auth().onAuthStateChanged(function(user) 
        {
            console.log('USer');
            if(user)
            {
                
                document.getElementById('submit-warning').style.display = "none";
                document.getElementById('form-submit-button').disabled = false;
                getDeparts();

                document.getElementById('officer-email').value = user.email;
                firebase.firestore().collection("profile")
                .where("email", "==", user.email)
                
                .get()
                .then((querySnapshot) => {
                    querySnapshot.forEach((doc) => {
                        profile=doc;
                    // doc.data() is never undefined for query doc snapshots
                    document.getElementById('id').value = doc.id;
                    document.getElementById('officer-name').value = doc.data().name;
                    document.getElementById('user-id').value = doc.data().id_number;
                    document.getElementById('user-rank').value = doc.data().rank;
                    document.getElementById('user-phone').value = doc.data().phone;
                    document.getElementById('user-stationNumber').value = doc.data().station_phone;

                    // console.log(doc.id);
                    });
                })
                .catch((e) => {
                    console.log(e);
                });
                
            }
            else
            {
                document.getElementById('form-submit-button').disabled = true;
            }
        });
        
    
        function getDeparts(){
            firebase.auth().onAuthStateChanged(function(user) 
            {
                var select = document.getElementById("departments");
                var option = document.createElement('option');
                        option.text = "Select Department";
                        option.value = "";
                        select.add(option, 0);
                firebase.firestore().collection("Department")
                .orderBy("Department_name", "desc")
                .get()
                .then((querySnapshot) => {
                    querySnapshot.forEach((doc) => {
                        var option = document.createElement('option');
                        option.text = doc.data().Department_name;
                        option.value = doc.id;
                        select.add(option, 0);
                    });
                })
                .catch((e) => {
                    console.log(e);
                });

                   
                
            });
        }
        </script>
    <!-- <script>
        function submitPageForm()
        {
            firebase.auth().onAuthStateChanged(function(user) 
            {
                if(user)
                {
                    firebase.firestore().collection("tutoringSessionConfirmations").add(
                        {     
                            tutorEmail                : user.email,
                            tutorSubmissionTimestamp  : firebase.firestore.FieldValue.serverTimestamp(),
                            tutorSignature            : document.getElementById("tutor-signature").value,
                            sessionDate               : document.getElementById("session-date").value,
                            sessionStart              : document.getElementById("session-start").value,
                            sessionEnd                : document.getElementById("session-end").value,
                            subject                   : +document.getElementById("subject-number").value, 
                            conceptCovered            : document.getElementById("concept-covered").value,
                            tutorNotes                : document.getElementById("tutor-notes").value,
                            tuteeEmail                : document.getElementById("tutee-email").value,
                            tuteeSignature            : null,
                            tuteeSignatureTimestamp   : null
                        })
                        .then (function(doc)
                        {
                            let uri = "https://bubbly-polygon-267201.web.app/tutoringSessionConfirmation2.html" + "?"+ doc.id;

                            alert("Document successfully submitted.")
                        })
                        .catch(function(error){alert("Error adding document:", error);});
                }
            });
        }
    </script> -->




       
          
 
            

           


</body>
</html>